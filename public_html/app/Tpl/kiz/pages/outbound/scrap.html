
{include file="inc/header.html"}

<div class="article-header">
    <div class="center-block w1200">
        <h1><span id="orderType">报废单</span></h1>

        <div class="btn-wrap pull-right tar">
            <a code="scm:button:scrap:scrap:add" function="$.doForward" args="{url:'/kiz.php?ctl=outbound&act=outbound_scrap_add'}" class="btn-link ml10" id="btn-create">创建</a>
        </div>
    </div>
</div>
<div class="center-block panel-group mt20">
    <!-- 左栏 start -->
    <div class="aside">
        <form id="queryConditions" action="#" method="post" autocomplete="off">
            <!-- 模糊查询 start -->
            <div class="aside-column panel-search">
                <h2>模糊查询</h2>

                <div class="search-box">
                    <input type="text" name="outboundNo" id="outboundNo" class="form-control" placeholder="请输入单据号"
                           data-format="sn" maxlength="14">
                    <button type="button" class="close" aria-hidden="true">&times;</button>
                </div>
            </div>
            <!-- 模糊查询 end -->
            <!-- 出库仓库 start -->
            <div class="aside-column">
                <h2>出库仓库</h2>

                <div>
                    <select class="form-control" name="warehouseId" id="warehouseId">
                        <option value="">请选择出库仓库</option>




                        <option value="9591">总仓库</option>






                        <option value="13260">饮品仓</option>






                        <option value="13261">酒水仓</option>






                        <option value="13262">原材料仓</option>






                        <option value="14838">4号库</option>






                        <option value="14839">5号库</option>



                    </select>
                </div>
            </div>
            <!-- 出库仓库 end -->
            <!-- 保存/确认日期 start -->
            <div class="aside-column">
                <h2>保存/确认日期</h2>
                <div class="search-box">
                    <input type="text" name="createDateStart" id="createDateStart" class="form-control datepicker-start"
                           data-for-element="createDateEnd" placeholder="请选择开始日期" readonly>
                    <button type="button" class="close" aria-hidden="true">&times;</button>
                </div>
                <div class="search-box mt10">
                    <input type="text" name="createDateEnd" id="createDateEnd" class="form-control datepicker-end"
                           data-for-element="createDateStart" placeholder="请选择结束日期" readonly>
                    <button type="button" class="close" aria-hidden="true">&times;</button>
                </div>
            </div>
            <!-- 保存/确认日期 end -->
            <!-- 状态 start -->
            <div class="aside-column">
                <h2>状态</h2>
                <ul class="panel-list-type">
                    <li><label class="checkbox checkbox-check" for="status-0"><span></span>
                        <input type="checkbox" name="status" id="status-0" checked value="0">已保存</label>
                    </li>
                    <li><label class="checkbox" for="status-1"><span></span>
                        <input type="checkbox" name="status" id="status-1" value="1">已确认</label></li>
                </ul>
            </div>
            <!-- 状态 end -->
        </form>
        <a class="link undo-all" id="undo-all">全部撤销</a>
        <a class="btn-blue btn-search" role="button"
           function="$.doSearch" args="{dataGridId:grid}">查 询</a>
    </div>
    <!-- 左栏 end -->
    <!-- 右栏 start -->
    <div class="panel main">
        <div class="panel-body">
            <!-- grid start -->
            <table id="grid"></table>
            <div id="gridPager"></div>
            <!-- grid end -->
        </div>
        <!-- 右栏 end -->
    </div>
</div>

<script>

    var urlRoot = "/scm_kry/outbound/scrap/";
    var queryUrl = urlRoot + "query";
    var editUrl = urlRoot + "edit";
    var withDrawUrl = urlRoot + 'withdraw';
    var deleteUrl = urlRoot + "delete";
    var viewUrl = urlRoot + "view";
    var confirmUrl = urlRoot + "doconfirm";
    var copyUrl = urlRoot + "copy";

    $(function () {
        //需要保存查询条件的页面
        var arrUrl = [
            'scm_kry/outbound/scrap/edit',
            'scm_kry/outbound/scrap/view',
            'scm_kry/outbound/scrap/add',
            'scm_kry/outbound/scrap/copy'
        ];
        //保存查询条件
        $.setQueryData(arrUrl);

        $.serializeGridDataCallback = function (formData) {
            if (typeof formData.status == "object" || typeof formData.status == "array" || formData.status == undefined) {
                formData["status"] = "-2";
            }
            return formData;
        };

        $.showEditor = function (rowData) {
            if (rowData.status == 0) {
                return renderEnum.normal;
            }
            return renderEnum.hidden;
        };

        $.showView = function (rowData) {
            if (rowData.status == 1) {
                return renderEnum.normal;
            }
            return renderEnum.hidden;
        };

        $.showWithDraw = function(rowData){
            if (rowData.status == 1) {
                return renderEnum.normal;
            }
            return renderEnum.hidden;
        };

        $.showConfirm = function (rowData) {
            if (rowData.status==0) return renderEnum.normal;
            if(rowData.status==1) return renderEnum.hidden;
            return renderEnum.disabled;
        };

        $.showDelete = function (rowData) {
            if (rowData.status == 0) {
                return renderEnum.normal;
            }
            return renderEnum.disabled;
        };

        $.showPrint = function (rowData) {
            if (rowData.status == 1) {
                return renderEnum.normal;
            }
            return renderEnum.disabled;
        };
        $.showCopy = function (rowData) {
            return renderEnum.normal;
        }

        var $gridObj = $("#grid");
        $gridObj.dataGrid({
            formId: "queryConditions",
            serializeGridDataCallback: $.serializeGridDataCallback,
            url: queryUrl,
            colNames: ['单据号', '保存 / 确认日期', '出库仓库', '报废数量', '报废金额', '状态', '状态'],
            colModel: [
                {name: 'outboundNo', index: 'outboundNo', width: 160, align: "center"},
                {name: 'updateTime', index: 'updateTime', width: 160, align: "center"},
                {name: 'warehouseName', index: 'warehouseName', width: 160},
                {name: 'qty', index: 'qty', width: 100, align: "right"},
                {
                    name: 'amount',
                    index: 'amount',
                    width: 120,
                    align: "right",
                    formatter: customCurrencyFormatter
                },
                {name: 'statusName', index: 'status', width: 100, align: "center"},
                {name: 'status', index: 'status', width: 100, align: "center", hidden:true}
            ],
            sortname: 'outboundNo',
            pager: "#gridPager",
            showOperate:true,
            actionParam: {
                editor: {
                    url: editUrl,
                    code: "scm:button:scrap:scrap:edit",
                    render: $.showEditor
                },
                view: {
                    url: viewUrl,
                    render: $.showView
                },
                confirm: {
                    url: confirmUrl,
                    code: "scm:button:scrap:scrap:confirm",
                    render: $.showConfirm
                },
                withdraw: {
                    url: withDrawUrl,
                    render: $.showWithDraw,
                    code: "scm:button:scrap:scrap:withdraw",
                    redirectUrl: editUrl
                },
                delete: {
                    url: deleteUrl,
                    code: "scm:button:scrap:scrap:delete",
                    render: $.showDelete
                },
                print: {
                    url: urlRoot,
                    render: $.showPrint
                },
                copy:{
                    url:copyUrl,
                    code: "scm:button:scrap:scrap:add",
                    render: $.showCopy
                }
            }
        });

        $.setSearchFocus();
    });



</script>
{include file="inc/footer.html"}

</body>
</html>